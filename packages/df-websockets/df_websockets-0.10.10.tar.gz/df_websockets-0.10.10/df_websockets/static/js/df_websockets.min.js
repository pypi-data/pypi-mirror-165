!function(e){var n={};function t(o){if(n[o])return n[o].exports;var l=n[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var l in e)t.d(o,l,function(n){return e[n]}.bind(null,l));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n,t){"use strict";function o(e){for(var n=[],t=0;t<e.elements.length;t++){var o=e.elements[t];if(o.name&&!o.disabled&&"reset"!==o.type&&"submit"!==o.type&&"button"!==o.type)if("file"===o.type)for(var l=0;l<o.files.length;l++)n.push({name:o.name,value:o.files[l].name});else if("select-multiple"===o.type)for(l=0;l<o.selectedOptions.length;l++)n.push({name:o.name,value:o.selectedOptions[l].value});else("checkbox"!==o.type&&"radio"!==o.type||o.checked)&&n.push({name:o.name,value:o.value})}return n}function l(e){document.querySelectorAll(e.selector).forEach((function(n){e.values.forEach((function(e){!function(e,n,t){var o=e.elements.namedItem(n);if(null!==o)if(o instanceof RadioNodeList)if(!0===t||!1===t)o.forEach((function(e){e.checked=t}));else if(Array.isArray(t)){var l=new Set(t);o.forEach((function(e){e.checked=l.has(e.value)}))}else o.forEach((function(e){e.checked=e.value===t}));else if(o instanceof HTMLTextAreaElement)o.value=t;else if(o instanceof HTMLInputElement&&"checkbox"===o.type)!0===t?o.checked=!0:!1===t?o.checked=!1:o.value=t;else if(o instanceof HTMLSelectElement){var i=o.options;if(Array.isArray(t))for(var r=new Set(t),c=0;c<i.length;c++)i[c].selected=r.has(i[c].value);else for(c=0;c<i.length;c++)i[c].selected=i[c].value===t}else o instanceof HTMLInputElement&&(o.value=t)}(n,e.name,e.value)}))}))}function i(e){e.target.querySelectorAll("[data-df-signal]").forEach((function(e){JSON.parse(e.getAttribute("data-df-signal")).forEach((function(n){var t=n.on;t||(t="FORM"===e.tagName?"submit":"INPUT"===e.tagName&&"reset"!==e.type&&"submit"!==e.type&&"button"!==e.type||"TEXTAREA"===e.tagName?"change":"click");e.addEventListener(t,(function(l){var i=n.prevent,r=n.opts||{};if(n.form&&(r[n.form]=o(e)),n.value)if("file"===e.type){r[n.value]=[];for(var c=0;c<e.files.length;c++)r[n.value].push(e.files[c].name)}else if("select-multiple"===e.type){r[n.value]=[];for(c=0;c<e.selectedOptions.length;c++)r[n.value].push(e.selectedOptions[c].value)}else"checkbox"===e.type||"radio"===e.type?r[n.value]=e.checked:r[n.value]=e.value;window.DFSignals.call(n.name,r),(!0===i||null===i&&"change"!==t)&&l.preventDefault()}))}))}))}t.r(n),t.d(n,"serializeForm",(function(){return o})),t.d(n,"htmlFormsSet",(function(){return l})),document.addEventListener("DOMContentAdded",(function(e){window.setTimeout((function(){i(e)}),200)})),document.addEventListener("DOMContentLoaded",(function(e){window.setTimeout((function(){i(e)}),200)}))},function(e,n,t){t(2),t(3),e.exports=t(0)},function(e,n){window.DFSignals={connection:null,buffer:[],registry:{},wsurl:null},document.addEventListener("DOMContentLoaded",(function e(){if(null===window.DFSignals.wsurl){const e=function(e){const n=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let o=t[e];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return""}("dfwsurl");window.DFSignals.wsurl=decodeURIComponent(e)}if(!window.DFSignals.wsurl)return void console.info("Unable to get the websocket URL in the 'dfwsurl' cookie.");const n=new WebSocket(window.DFSignals.wsurl);n.onopen=()=>{window.DFSignals.connection=n;for(let e=0;e<window.DFSignals.buffer.length;e++)n.send(window.DFSignals.buffer[e]);window.DFSignals.buffer=[]},n.onmessage=e=>{console.debug("received call "+e.data+" from server.");const n=JSON.parse(e.data);n.signal&&n.signal_id&&window.DFSignals.call(n.signal,n.opts,n.signal_id)},n.onerror=e=>{console.error("WS error: "+e)},n.onclose=()=>{window.DFSignals.connection=null,setTimeout(e,3e3)}})),window.DFSignals.call=function(e,n,t){if(void 0!==t&&void 0!==window.DFSignals.registry[t])return!1;if(void 0!==t&&(window.DFSignals.registry[t]=!0),void 0!==window.DFSignals.registry[e]){console.debug('call "'+e+'"',n);for(let o=0;o<window.DFSignals.registry[e].length;o+=1)window.DFSignals.registry[e][o](n,t)}if(void 0===t){console.debug('call from client: "'+e+'"',n);const t=JSON.stringify({signal:e,opts:n});window.DFSignals.connection?window.DFSignals.connection.send(t):window.DFSignals.buffer.push(t)}return!1},window.DFSignals.connect=function(e,n){void 0===window.DFSignals.registry[e]&&(window.DFSignals.registry[e]=[]),window.DFSignals.registry[e].push(n)}},function(e,n,t){"use strict";t.r(n);var o=t(0);const l=e=>{document.querySelectorAll(e.selector).forEach(n=>{const t=n.nextSibling;n.insertAdjacentHTML("afterend",e.content);let o=n.nextSibling;for(;o&&o!==t;)o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.nextSibling})},i=e=>{document.querySelectorAll(e.selector).forEach(n=>{const t=n.lastChild;n.insertAdjacentHTML("beforeend",e.content);let o=n.lastChild;for(;o&&o!==t;)o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.previousSibling})},r=e=>{document.querySelectorAll(e.selector).forEach(n=>{const t=n.firstChild;n.insertAdjacentHTML("afterbegin",e.content);let o=n.firstChild;for(;o&&o!==t;)o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.nextSibling})},c=e=>{document.querySelectorAll(e.selector).forEach(n=>{const t=n.previousSibling;n.insertAdjacentHTML("beforebegin",e.content);let o=n.previousSibling;for(;o&&o!==t;)o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.previousSibling})},s=e=>{document.querySelectorAll(e.selector).forEach(n=>{n.innerHTML=e.content;let t=n.firstChild;for(;t;)t.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),t=t.nextSibling})},a=e=>{document.querySelectorAll(e.selector).forEach(n=>{const t=n.previousSibling,o=n.nextSibling,l=n.parentNode;n.outerHTML=e.content;let i=l.firstChild;for(t&&(i=t.nextSibling);i&&i!==o;)i.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),i=i.nextSibling})},d=e=>{document.querySelectorAll(e.selector).forEach(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)})},u=e=>{document.querySelectorAll(e.selector).forEach(e=>{e.parentNode.removeChild(e)})},f=e=>{document.querySelectorAll(e.selector).forEach(n=>{n.textContent=e.content})},w=e=>{document.querySelectorAll(e.selector).forEach(n=>{n.classList.add(e.class_name)})},g=e=>{document.querySelectorAll(e.selector).forEach(n=>{n.classList.remove(e.class_name)})},m=e=>{document.querySelectorAll(e.selector).forEach(n=>{n.removeAttribute(e.attr_name)})},h=e=>{document.querySelectorAll(e.selector).forEach(n=>{n.setAttribute(e.attr_name,e.attr_value)})},v=e=>{document.querySelectorAll(e.selector).forEach(n=>{e.value?n.setAttribute(e.name,e.name):n.removeAttribute(e.name)})},S=e=>{const n=document.createElement("a");n.href=e.url,n.target="_blank",n.download=e.filename||"unknown";const t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(t),(window.URL||window.webkitURL).revokeObjectURL(n.href)},b=e=>{const n=document.querySelector(e.selector);n&&n.focus({preventScroll:!1})};document.addEventListener("DOMContentLoaded",(function(){window.DFSignals.connect("html.after",l),window.DFSignals.connect("html.append",i),window.DFSignals.connect("html.prepend",r),window.DFSignals.connect("html.before",c),window.DFSignals.connect("html.content",s),window.DFSignals.connect("html.replace_with",a),window.DFSignals.connect("html.empty",d),window.DFSignals.connect("html.remove",u),window.DFSignals.connect("html.add_class",w),window.DFSignals.connect("html.remove_class",g),window.DFSignals.connect("html.remove_attr",m),window.DFSignals.connect("html.add_attribute",h),window.DFSignals.connect("html.boolean_attribute",v),window.DFSignals.connect("html.text",f),window.DFSignals.connect("html.download_file",S),window.DFSignals.connect("html.focus",b),window.DFSignals.connect("html.forms.set",o.htmlFormsSet)}))}]);
//# sourceMappingURL=df_websockets.min.js.map