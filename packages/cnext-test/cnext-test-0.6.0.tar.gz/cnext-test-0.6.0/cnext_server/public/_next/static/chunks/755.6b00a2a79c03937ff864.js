(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{87451:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return z}});var o=t(30266),i=t(809),r=t.n(i),s=t(67294),a=t(79622),l=t(76240),c=t(12617),u=t(91920),h=t(93942),f=t(68216),p=t(25997),d=t(14695),v=t(13444),m=t(30268),y=t(92953),g=t(92809),k=(t(15662),t(12320)),R=t(85893);function C(n){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var t,o=(0,y.Z)(n);if(e){var i=(0,y.Z)(this).constructor;t=Reflect.construct(o,arguments,i)}else t=o.apply(this,arguments);return(0,m.Z)(this,t)}}var b,Z,S=function(n){(0,v.Z)(t,n);var e=C(t);function t(n){var o;return(0,f.Z)(this,t),o=e.call(this,n),(0,g.Z)((0,d.Z)(o),"terminalRef",void 0),(0,g.Z)((0,d.Z)(o),"terminal",void 0),o.terminalRef=s.createRef(),o.onData=o.onData.bind((0,d.Z)(o)),o.onCursorMove=o.onCursorMove.bind((0,d.Z)(o)),o.onKey=o.onKey.bind((0,d.Z)(o)),o.onBinary=o.onBinary.bind((0,d.Z)(o)),o.onLineFeed=o.onLineFeed.bind((0,d.Z)(o)),o.onScroll=o.onScroll.bind((0,d.Z)(o)),o.onSelectionChange=o.onSelectionChange.bind((0,d.Z)(o)),o.onRender=o.onRender.bind((0,d.Z)(o)),o.onResize=o.onResize.bind((0,d.Z)(o)),o.onTitleChange=o.onTitleChange.bind((0,d.Z)(o)),o.setupTerminal(),o}return(0,p.Z)(t,[{key:"setupTerminal",value:function(){var n=this;this.terminal=new k.Terminal(this.props.options),this.props.addons&&this.props.addons.forEach((function(e){n.terminal.loadAddon(e)})),this.terminal.onBinary(this.onBinary),this.terminal.onCursorMove(this.onCursorMove),this.terminal.onData(this.onData),this.terminal.onKey(this.onKey),this.terminal.onLineFeed(this.onLineFeed),this.terminal.onScroll(this.onScroll),this.terminal.onSelectionChange(this.onSelectionChange),this.terminal.onRender(this.onRender),this.terminal.onResize(this.onResize),this.terminal.onTitleChange(this.onTitleChange),this.props.customKeyEventHandler&&this.terminal.attachCustomKeyEventHandler(this.props.customKeyEventHandler)}},{key:"componentDidMount",value:function(){this.terminalRef.current&&this.terminal.open(this.terminalRef.current)}},{key:"componentWillUnmount",value:function(){this.terminal.dispose()}},{key:"onBinary",value:function(n){this.props.onBinary&&this.props.onBinary(n)}},{key:"onCursorMove",value:function(){this.props.onCursorMove&&this.props.onCursorMove()}},{key:"onData",value:function(n){this.props.onData&&this.props.onData(n)}},{key:"onKey",value:function(n){this.props.onKey&&this.props.onKey(n)}},{key:"onLineFeed",value:function(){this.props.onLineFeed&&this.props.onLineFeed()}},{key:"onScroll",value:function(n){this.props.onScroll&&this.props.onScroll(n)}},{key:"onSelectionChange",value:function(){this.props.onSelectionChange&&this.props.onSelectionChange()}},{key:"onRender",value:function(n){this.props.onRender&&this.props.onRender(n)}},{key:"onResize",value:function(n){this.props.onResize&&this.props.onResize(n)}},{key:"onTitleChange",value:function(n){this.props.onTitleChange&&this.props.onTitleChange(n)}},{key:"render",value:function(){return(0,R.jsx)("div",{className:this.props.className,ref:this.terminalRef})}}]),t}(s.Component),w=t(59936),T=t(2946),B=t(77025),F="Failed to fetch",x="terminalIO",z=function(){u.Z.getState();var n=(0,h.v9)((function(n){var e;return null===(e=n.projectManager.activeProject)||void 0===e?void 0:e.path})),e=(0,s.useRef)(null),t=new c.FitAddon,i=(0,h.v9)((function(n){return n.terminal.config}));function f(){return(f=(0,o.Z)(r().mark((function o(){var s,c,u,h,f,p;return r().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.port||!i.token){o.next=27;break}return o.prev=1,s="".concat((0,B.g)(),":").concat(i.port),c="".concat(i.token),u="ws:"+s.split(":").slice(1).join(":"),h=l.ServerConnection.makeSettings({baseUrl:s,wsUrl:u,token:c,init:{}}),a.PageConfig.setOption("terminalsAvailable","true"),f=new l.TerminalManager({serverSettings:h}),o.next=10,l.TerminalAPI.listRunning(h);case 10:if(p=o.sent,p.find((function(n){return n.name===x}))){o.next=18;break}return o.next=15,f.startNew({name:x,cwd:n});case 15:Z=o.sent,o.next=19;break;case 18:Z=f.connectTo({model:{name:x}});case 19:Z.messageReceived.connect((function(n,t){var o;switch(t.type){case"stdout":var i;if(t.content)null===e||void 0===e||null===(i=e.current)||void 0===i||i.terminal.write(t.content[0]);break;case"disconnect":null===e||void 0===e||null===(o=e.current)||void 0===o||o.terminal.write("\r\n\r\n[Finished\u2026 Term Session]\r\n")}})),b=document.getElementById("Terminal"),new ResizeObserver((function(){void 0!==t&&t.fit()})).observe(b),o.next=27;break;case 24:o.prev=24,o.t0=o.catch(1),(null===o.t0||void 0===o.t0?void 0:o.t0.message)===F&&((0,T.Bt)(),window.location.reload());case 27:case"end":return o.stop()}}),o,null,[[1,24]])})))).apply(this,arguments)}(0,s.useEffect)((function(){return function(){f.apply(this,arguments)}(),function(){}}),[i]),(0,s.useEffect)((function(){null!==e&&void 0!==e&&e.current}),[Z]);var p=(0,w.ZP)(S).withConfig({displayName:"Terminal__StyleXTerm",componentId:"sc-11fg78k-0"})(["height:100%;"]);return(0,R.jsx)(p,{onResize:function(n){var o;if(null!==e&&void 0!==e&&null!==(o=e.current)&&void 0!==o&&o.terminal&&Z){n.rows,n.cols,b.offsetHeight,b.offsetWidth;Z.isDisposed||t.fit()}},options:{cursorBlink:!0,cursorStyle:"bar",cursorWidth:2,convertEol:!0,fontFamily:"monospace",fontSize:13,lineHeight:1.2,fontWeight:400,theme:{selection:"#b1b1b155",background:"white",foreground:"#808080",cursor:"#808080"}},addons:[t],onData:function(n){Z&&Z.send({type:"stdin",content:[n]})},ref:e})}},21763:function(){}}]);