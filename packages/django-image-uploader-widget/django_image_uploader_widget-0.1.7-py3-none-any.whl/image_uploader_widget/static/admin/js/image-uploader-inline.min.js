(()=>{"use strict";var e={925:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" width="100%" height="100%"><path xmlns="http://www.w3.org/2000/svg" d="m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"></path></svg>'},668:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default='<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-zoom-in" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" width="100%" height="100%"><path xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"></path><path xmlns="http://www.w3.org/2000/svg" d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"></path><path xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"></path></svg>'},275:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageUploaderInline=void 0;const i=n(486),l=n(979);t.ImageUploaderInline=class{constructor(e){this.handleImageDelete=e=>{var t;e.element.getAttribute("data-raw")?(e.element.classList.add("deleted"),e.element.querySelector("input[type=checkbox]").checked=!0):null===(t=e.element.parentElement)||void 0===t||t.removeChild(e.element),this.images=this.images.filter((t=>t!==e)),this.updateEmpty()},this.handleDrop=e=>{var t;if(e.preventDefault(),this.element.classList.remove("drop-zone"),null===(t=e.dataTransfer)||void 0===t?void 0:t.files.length)for(const t of e.dataTransfer.files)this.addFile(t)},this.handleDragEnter=()=>{this.element.classList.add("drop-zone")},this.handleDragOver=e=>{e&&e.preventDefault()},this.handleDragLeave=e=>{e.relatedTarget&&e.relatedTarget.closest(".iuw-inline-root")===this.element||this.element.classList.remove("drop-zone")},this.canPreview=!0,this.tempFileInput=null,this.element=e,this.inlineGroup=(0,i.getInlineGroupOrThrow)(this.element),this.inlineFormset=(0,i.parseFormSet)(this.inlineGroup),this.management=(0,i.getManagementInputs)(this.inlineFormset.options.prefix),this.next=0,""===this.management.maxNumForms.value?this.maxCount=Number.MAX_SAFE_INTEGER:this.maxCount=parseInt(this.management.maxNumForms.value,10),this.addImageButton=(0,i.getAddButton)(this.element),this.updateEmpty(),this.updateAllIndexes(),this.images=Array.from(this.element.querySelectorAll(".inline-related")).map((e=>{const t=new l.EditorImage(e,this.canPreview);return t.onDelete=this.handleImageDelete,t})),this.bindVariables(),this.bindEvents(),this.element.addEventListener("dragenter",this.handleDragEnter),this.element.addEventListener("dragover",this.handleDragOver),this.element.addEventListener("dragleave",this.handleDragLeave),this.element.addEventListener("dragend",this.handleDragLeave),this.element.addEventListener("drop",this.handleDrop)}bindVariables(){this.handleAddImage=this.handleAddImage.bind(this),this.handleTempFileInputChange=this.handleTempFileInputChange.bind(this)}bindEvents(){var e;this.addImageButton.addEventListener("click",this.handleAddImage),null===(e=this.element.querySelector(".iuw-empty"))||void 0===e||e.addEventListener("click",this.handleAddImage)}updateEmpty(){const{length:e}=this.element.querySelectorAll(".inline-related:not(.empty-form):not(.deleted)");this.element.classList.toggle("non-empty",e>0)}updateAllIndexes(){const{prefix:e}=this.inlineFormset.options,{length:t}=Array.from(this.element.querySelectorAll(".inline-related:not(.empty-form)")).map(((t,n)=>((0,i.updateAllElementsIndexes)(t,e,n),t)));this.next=t,this.management.totalForms.value=String(this.next),this.addImageButton.classList.toggle("visible-by-number",this.maxCount-this.next>0)}createFromEmptyTemplate(){var e;const t=this.element.querySelector(".inline-related.empty-form");if(!t)throw new Error("no-empty-template");const n=t.cloneNode(!0);return n.classList.remove("empty-form"),n.classList.remove("last-related"),n.setAttribute("data-candelete","true"),n.id=`${this.inlineFormset.options.prefix}-${this.next}`,null===(e=t.parentElement)||void 0===e||e.insertBefore(n,t),n}addFile(e=null){var t;const n=this.createFromEmptyTemplate();let i=null;if(e){i=e;const t=n.querySelector("input[type=file]"),l=new DataTransfer;l.items.add(i),t.files=l.files}else{if(!this.tempFileInput)throw new Error("no-temp-input-for-upload");if(i=(this.tempFileInput.files||[null])[0],!i)throw new Error("no-file-in-input");const e=n.querySelector("input[type=file]"),l=e.parentElement,r=e.className,a=e.getAttribute("name");l.removeChild(e),this.tempFileInput.className=r,this.tempFileInput.setAttribute("name",a||""),null===(t=this.tempFileInput.parentElement)||void 0===t||t.removeChild(this.tempFileInput),l.appendChild(this.tempFileInput),this.tempFileInput=null}const r=new l.EditorImage(n,!0,URL.createObjectURL(i));r.onDelete=this.handleImageDelete,this.images.push(r),this.updateEmpty(),this.updateAllIndexes()}handleTempFileInputChange(){var e;const t=null===(e=this.tempFileInput)||void 0===e?void 0:e.files;!t||t.length<=0||this.addFile()}handleAddImage(){this.tempFileInput||(this.tempFileInput=(0,i.createTempFileInput)(),this.tempFileInput.addEventListener("change",this.handleTempFileInputChange),this.element.appendChild(this.tempFileInput)),this.tempFileInput.click()}}},979:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorImage=void 0;const l=i(n(668)),r=i(n(925)),a=n(965);t.EditorImage=class{constructor(e,t,n){if(this.element=e,this.canPreview=t,this.onDelete=null,this.handleClick=this.handleClick.bind(this),this.handleInputChange=this.handleInputChange.bind(this),n)this.render(n);else{const e=this.removeAndGetInputs(),t=this.getAndUpdateRawImage();this.element.innerHTML="",e.forEach((e=>this.element.appendChild(e))),this.render(t)}}removeAndGetInputs(){return Array.from(this.element.querySelectorAll("input[type=hidden], input[type=checkbox], input[type=file]")).map((e=>{var t;return null===(t=e.parentElement)||void 0===t||t.removeChild(e),e}))}getAndUpdateRawImage(){let e=document.querySelector("p.file-upload a");this.element.classList.contains("empty-form")&&(e=null);let t=null;return e&&(t=e.getAttribute("href"),t&&this.element.setAttribute("data-raw",t)),t}render(e){var t;if(!e)return;let n=null;const i=this.element.closest(".inline-related");if(null==i||i.addEventListener("click",this.handleClick),null===(t=null==i?void 0:i.querySelector("input[type=file]"))||void 0===t||t.addEventListener("change",this.handleInputChange),"true"===(null==i?void 0:i.getAttribute("data-candelete"))&&(n=document.createElement("span"),n.classList.add("iuw-delete-icon"),n.innerHTML=r.default),this.canPreview){const e=document.createElement("span");e.classList.add("iuw-preview-icon"),"true"!==(null==i?void 0:i.getAttribute("data-candelete"))&&e.classList.add("iuw-only-preview"),e.innerHTML=l.default,this.element.appendChild(e)}const a=document.createElement("img");a.src=e,this.element.appendChild(a),n&&this.element.appendChild(n)}handleClick(e){if(!e||!e.target)return;const t=e.target,n=t.closest(".inline-related");if(t.closest(".iuw-delete-icon")&&this.onDelete)return void this.onDelete(this);if(t.closest(".iuw-preview-icon")){let e=null==n?void 0:n.querySelector("img");if(e)return e=e.cloneNode(!0),a.PreviewModal.createPreviewModal(e),void a.PreviewModal.openPreviewModal()}const i=null==n?void 0:n.querySelector("input[type=file]");e.target!==i&&(null==i||i.click())}handleInputChange(e){var t;if(!e||!e.target||"INPUT"!==e.target.tagName)return;const n=e.target;var i=n.files;if(!(null==i?void 0:i.length))return;const l=null===(t=n.closest(".inline-related"))||void 0===t?void 0:t.querySelector("img");l&&(l.src=URL.createObjectURL(i[0]))}}},486:(e,t)=>{function n(e,t,n){const i=new RegExp(`(${t}-(\\d+|__prefix__))`),l=`${t}-${n}`,r=e.getAttribute("for");r&&e.setAttribute("for",r.replace(i,l));const a=e.getAttribute("id");a&&e.setAttribute("id",a.replace(i,l));const s=e.getAttribute("name");s&&e.setAttribute("name",s.replace(i,l))}Object.defineProperty(t,"__esModule",{value:!0}),t.createTempFileInput=t.getAddButton=t.getManagementInputs=t.updateAllElementsIndexes=t.updateElementIndex=t.parseFormSet=t.getInlineGroupOrThrow=void 0,t.getInlineGroupOrThrow=function(e){const t=e.closest(".inline-group");if(!t)throw new Error("no-inline-group-found");return t},t.parseFormSet=function(e){const t=e.getAttribute("data-inline-formset");if(!t)throw new Error("no-formset-data-found");return JSON.parse(t)},t.updateElementIndex=n,t.updateAllElementsIndexes=function(e,t,i){n(e,t,i),Array.from(e.querySelectorAll("*")).forEach((e=>n(e,t,i)))},t.getManagementInputs=function(e){const t=document.querySelector(`#id_${e}-TOTAL_FORMS`),n=document.querySelector(`#id_${e}-INITIAL_FORMS`),i=document.querySelector(`#id_${e}-MIN_NUM_FORMS`),l=document.querySelector(`#id_${e}-MAX_NUM_FORMS`);if(!(t&&n&&i&&l))throw new Error("management-forms-not-found");return{totalForms:t,initialForms:n,minNumForms:i,maxNumForms:l}},t.getAddButton=function(e){const t=e.querySelector(".iuw-add-image-btn");if(!t)throw new Error("no-add-button-found");return t},t.createTempFileInput=function(){const e=document.createElement("input");return e.setAttribute("type","file"),e.classList.add("temp_file"),e.setAttribute("accept","image/*"),e.style.display="none",e}},916:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewModal=void 0,t.PreviewModal={openPreviewModal:()=>{const e=document.getElementById("iuw-modal-element");e&&setTimeout((()=>{e.classList.add("visible"),e.classList.remove("hide"),document.body.style.overflow="hidden"}),50)},closePreviewModal:()=>{document.body.style.overflow="auto";const e=document.getElementById("iuw-modal-element");e&&(e.classList.remove("visible"),e.classList.add("hide"),setTimeout((()=>{var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}),300))},onModalClick:e=>{e&&e.target&&e.target.closest("img.iuw-modal-image-preview-item")||t.PreviewModal.closePreviewModal()},createPreviewModal:e=>{e.className="",e.classList.add("iuw-modal-image-preview-item");const n=document.createElement("div");n.id="iuw-modal-element",n.classList.add("iuw-modal","hide"),n.addEventListener("click",t.PreviewModal.onModalClick);const i=document.createElement("div");return i.classList.add("iuw-modal-image-preview"),i.innerHTML='<span class="iuw-modal-close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" width="100%" height="100%"><path xmlns="http://www.w3.org/2000/svg" d="m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"></path></svg></span>',i.appendChild(e),n.appendChild(i),document.body.appendChild(n),n}}},965:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),l=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),l(n(916),t)}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}(()=>{const e=n(275);document.addEventListener("DOMContentLoaded",(()=>{Array.from(document.querySelectorAll(".iuw-inline-root")).map((t=>new e.ImageUploaderInline(t)))}))})()})();